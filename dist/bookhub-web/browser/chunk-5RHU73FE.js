import{a as Re,b as Fe,c as Te,d as Le,e as ze}from"./chunk-ALOQZW27.js";import{i as Ue}from"./chunk-CA4L5CKF.js";import"./chunk-GKRRSJBF.js";import{A as q,B as Pe,C as _e,F as H,G as Me,H as $,I as N,K as V,L as ke,N as ye,O as Oe,Q as we,R as Se,S as Ie,T as G,U as Ee,V as Q,W,X as De,Z as Ne,ma as J,na as Be,w as be,x as Ce,y as xe,z as ve}from"./chunk-7QRJM3WR.js";import{a as fe,b as I,h as j,i as ge,j as P,k as he,n as _,p as E}from"./chunk-F3GBKEZA.js";import"./chunk-Q64FFBLU.js";import{Db as ae,Fc as z,Gb as g,Hc as ue,Ib as x,Ic as A,Jc as v,Sb as a,Tb as L,Ub as u,Vb as ce,Wa as s,Wb as pe,Xb as le,Yb as me,Z as S,_b as m,a as ie,ac as de,bc as y,cc as O,da as c,ha as l,lb as C,pb as d,qa as B,qb as D,ra as T,tb as b,ub as se,vb as M,wb as k,xb as r,yb as n,zb as p}from"./chunk-2LSH2JKS.js";function $e(o,t){if(o&1&&p(0,"app-book-card",6),o&2){let e=t.$implicit;d("book",e)}}function Ve(o,t){o&1&&(r(0,"p"),a(1,"No se encontraron libros"),n())}var K=class o{recentBooks=[];filteredBooks=[];searchQuery="";bookService=c(Fe);router=c(P);constructor(){}ngOnInit(){this.bookService.getRecentBooks().subscribe({next:t=>{this.recentBooks=t,this.filteredBooks=t},error:t=>console.error("Error al cargar los libros recientes",t)})}onSearch(){let t=this.searchQuery.toLowerCase();this.filteredBooks=this.recentBooks.filter(e=>e.title.toLowerCase().includes(t)||e.authorName.toLowerCase().includes(t))}goToCart(){this.router.navigate(["/customer/cart"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-catalog"]],standalone:!0,features:[m],decls:13,vars:2,consts:[[1,"content-wrapper"],[1,"search-container"],["appearance","outline",1,"search-bar"],["matInput","","placeholder","Busca por t\xEDtulo o autor",3,"ngModelChange","ngModel"],["mat-icon-button","","matSuffix",""],[1,"book-list"],[3,"book"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),a(4,"Buscar libros"),n(),r(5,"input",3),me("ngModelChange",function(F){return le(i.searchQuery,F)||(i.searchQuery=F),F}),g("ngModelChange",function(){return i.onSearch()}),n(),r(6,"button",4)(7,"mat-icon"),a(8,"search"),n()()()(),r(9,"div",5),M(10,$e,1,1,"app-book-card",6,se,!1,Ve,2,0,"p"),n()()),e&2&&(s(5),pe("ngModel",i.searchQuery),s(5),k(i.filteredBooks))},dependencies:[Me,H,q,_e,W,Q,Ce,be,G,$,V,ye,Re],styles:[".content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:20px;max-width:1200px;margin:0 auto}.search-container[_ngcontent-%COMP%]{width:100%;max-width:800px;margin-bottom:20px;padding:10px;border-radius:8px;background-color:#fff;display:flex;align-items:center;transition:box-shadow .3s ease}.search-container[_ngcontent-%COMP%]:hover{box-shadow:0 6px 14px #00000026}.search-bar[_ngcontent-%COMP%]{flex:1;width:100%}.book-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;justify-content:center;width:100%;max-width:1200px}.book-details-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;max-width:800px;margin:auto;transition:box-shadow .3s ease;border-radius:8px;overflow:hidden;background-color:#fff}.book-cover[_ngcontent-%COMP%]{width:40%;height:auto;object-fit:cover}.book-content[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;justify-content:space-between}.book-title[_ngcontent-%COMP%]{color:#333;font-weight:700;font-size:1.5rem;margin:0}.book-subtitle[_ngcontent-%COMP%]{color:#555;font-size:1rem;margin:5px 0 15px}.book-description[_ngcontent-%COMP%]{color:#666;font-size:1rem;line-height:1.6;margin-bottom:20px}.book-price[_ngcontent-%COMP%], .book-date[_ngcontent-%COMP%]{font-size:1rem;color:#333;margin-bottom:10px}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:15px;flex-wrap:wrap;justify-content:flex-end}.download-link[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%], .add-to-cart-button[_ngcontent-%COMP%]{display:inline-block;text-decoration:none;padding:10px 20px;background-color:#1abc9c;color:#fff;border-radius:5px;font-weight:700;text-align:center;transition:background-color .3s ease,box-shadow .3s ease;cursor:pointer;min-width:120px}.download-link[_ngcontent-%COMP%]:hover, .back-button[_ngcontent-%COMP%]:hover, .add-to-cart-button[_ngcontent-%COMP%]:hover{background-color:#158467;box-shadow:0 4px 8px #0003}.no-book-message[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;color:#666;background-color:#f8f8f8;padding:20px;max-width:600px;margin:40px auto}@media (max-width: 768px){.book-details-card[_ngcontent-%COMP%]{flex-direction:column;max-width:100%}.book-cover[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:8px 8px 0 0}.book-content[_ngcontent-%COMP%]{padding:15px}.book-title[_ngcontent-%COMP%]{font-size:1.3rem}.book-description[_ngcontent-%COMP%], .book-price[_ngcontent-%COMP%], .book-date[_ngcontent-%COMP%]{font-size:.95rem}.download-link[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%], .add-to-cart-button[_ngcontent-%COMP%]{padding:8px 15px;font-size:.9rem}}"]})};var X=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-collection"]],standalone:!0,features:[m],decls:2,vars:0,template:function(e,i){e&1&&(r(0,"p"),a(1,"collection works!"),n())}})};var Ge=(o,t)=>({"icon-white":o,"icon-black":t}),Y=class o{isSidebarActive=!1;toggleSidebar(){this.isSidebarActive=!this.isSidebarActive}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-layout"]],standalone:!0,features:[m],decls:22,vars:8,consts:[[1,"layout-dashboard"],[1,"sidebar-toggle-btn",3,"click"],[1,"navbar-toggler-icon",3,"ngClass"],[1,"layout-sidebar"],["routerLink","catalog","routerLinkActive","active"],[1,"fas","fa-book"],["routerLink","/customer/purchases/history","routerLinkActive","active"],[1,"fas","fa-shopping-cart"],["routerLink","collection","routerLinkActive","active"],[1,"fas","fa-bookmark"],[1,"layout-content"]],template:function(e,i){e&1&&(p(0,"app-navbar"),r(1,"div",0)(2,"button",1),g("click",function(){return i.toggleSidebar()}),p(3,"span",2),n(),r(4,"div",3)(5,"nav")(6,"ul")(7,"li")(8,"a",4),p(9,"i",5),a(10," Cat\xE1logo de Libros "),n()(),r(11,"li")(12,"a",6),p(13,"i",7),a(14," Mis Compras "),n()(),r(15,"li")(16,"a",8),p(17,"i",9),a(18," Colecci\xF3n de Libros "),n()()()()(),r(19,"div",10),p(20,"router-outlet"),n()(),p(21,"app-footer")),e&2&&(s(2),D("active",i.isSidebarActive),s(),d("ngClass",de(5,Ge,!i.isSidebarActive,i.isSidebarActive)),s(),D("collapsed",i.isSidebarActive))},dependencies:[v,z,xe,ve,ge,he],styles:[`.layout-dashboard[_ngcontent-%COMP%]{display:flex;height:100vh}app-navbar[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;z-index:1050}.layout-sidebar[_ngcontent-%COMP%]{position:fixed;top:70px;left:0;bottom:70px;width:250px;background-color:#343a40;color:#fff;overflow-y:auto;transition:width .3s ease-in-out;z-index:1040}.layout-sidebar.collapsed[_ngcontent-%COMP%]{width:0;overflow:hidden}.layout-sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.layout-sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:10px 0;padding:10px 20px}.layout-sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;display:flex;align-items:center;padding:10px;border-radius:4px;transition:background-color .3s}.layout-sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.layout-sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .layout-sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#495057}.layout-content[_ngcontent-%COMP%]{flex-grow:1;padding:90px 20px 70px;margin-left:250px;transition:margin-left .3s ease-in-out}.layout-sidebar.collapsed[_ngcontent-%COMP%] + .layout-content[_ngcontent-%COMP%]{margin-left:0}.sidebar-toggle-btn[_ngcontent-%COMP%]{position:fixed;top:70px;left:10px;background-color:transparent;border:none;font-size:24px;cursor:pointer;z-index:1060;color:#fff}.sidebar-toggle-btn.active[_ngcontent-%COMP%]   .navbar-toggler-icon[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml;charset=utf8,%3Csvg viewBox='0 0 30 30' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='rgba%280, 0, 0, 1%29' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E")}.icon-white[_ngcontent-%COMP%]{color:#fff}.icon-black[_ngcontent-%COMP%]{color:#000}app-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;height:70px;background-color:#343a40;color:#fff;text-align:center;z-index:1050}`]})};var U=class o{baseURL=`${_.apiUrl}/user/profile`;http=c(I);getUserProfile(t){return this.http.get(`${this.baseURL}/${t}`)}updateUserProfile(t,e){return this.http.put(`${this.baseURL}/${t}`,e)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};function Qe(o,t){o&1&&(r(0,"mat-error"),a(1,"Este campo es obligatorio"),n())}function We(o,t){o&1&&(r(0,"mat-error"),a(1,"Este campo es obligatorio"),n())}function Je(o,t){o&1&&(r(0,"mat-error"),a(1,"Este campo es obligatorio"),n())}function Ke(o,t){o&1&&(r(0,"mat-error"),a(1,"Introduzca un correo electr\xF3nico v\xE1lido"),n())}var Z=class o{profileForm;profile;fb=c(Ie);userProfileService=c(U);authService=c(E);router=c(P);snackBar=c(J);constructor(){this.profileForm=this.fb.group({firstName:["",N.required],lastName:["",N.required],email:["",[N.required,N.email]],shippingAddress:[""]})}ngOnInit(){this.loadUserProfile()}loadUserProfile(){let e=this.authService.getUser()?.id;e?this.userProfileService.getUserProfile(e).subscribe({next:i=>{this.profile=i,this.profileForm.patchValue(i)},error:()=>{this.showSnackBar("Error al cargar el perfil del usuario.")}}):(this.showSnackBar("Usuario no autenticado."),this.router.navigate(["/auth/login"]))}controlHasError(t,e){return this.profileForm.controls[t].hasError(e)}onSubmit(){if(this.profileForm.valid){let t=ie(ie({},this.profile),this.profileForm.value);this.userProfileService.updateUserProfile(this.profile.id,t).subscribe({next:()=>{this.showSnackBar("Perfil actualizado exitosamente."),this.router.navigate(["/customer/profile"])},error:e=>{this.showSnackBar(e.error?.message||"Error al actualizar el perfil.")}})}}showSnackBar(t){this.snackBar.open(t,"Cerrar",{duration:3e3})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-update-profile"]],standalone:!0,features:[m],decls:28,vars:6,consts:[[1,"update-profile-container"],[1,"update-profile-card"],[1,"update-profile-form"],[3,"ngSubmit","formGroup"],[1,"form-field"],["matInput","","formControlName","firstName","placeholder","Ingrese su nombre"],["matInput","","formControlName","lastName","placeholder","Ingrese su apellido"],["matInput","","formControlName","email","type","email","placeholder","Ingrese su correo electr\xF3nico"],["matInput","","formControlName","shippingAddress","placeholder","Ingrese su direcci\xF3n de env\xEDo"],["mat-raised-button","","color","primary","type","submit",1,"submit-button",3,"disabled"]],template:function(e,i){e&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2"),a(4,"Actualizar Perfil"),n(),r(5,"form",3),g("ngSubmit",function(){return i.onSubmit()}),r(6,"mat-form-field",4)(7,"mat-label"),a(8,"Nombre"),n(),p(9,"input",5),C(10,Qe,2,0,"mat-error"),n(),r(11,"mat-form-field",4)(12,"mat-label"),a(13,"Apellido"),n(),p(14,"input",6),C(15,We,2,0,"mat-error"),n(),r(16,"mat-form-field",4)(17,"mat-label"),a(18,"Correo Electr\xF3nico"),n(),p(19,"input",7),C(20,Je,2,0,"mat-error")(21,Ke,2,0,"mat-error"),n(),r(22,"mat-form-field",4)(23,"mat-label"),a(24,"Direcci\xF3n de Env\xEDo"),n(),p(25,"input",8),n(),r(26,"button",9),a(27," Guardar Cambios "),n()()()()()),e&2&&(s(5),d("formGroup",i.profileForm),s(5),b(i.controlHasError("firstName","required")?10:-1),s(5),b(i.controlHasError("lastName","required")?15:-1),s(5),b(i.controlHasError("email","required")?20:-1),s(),b(i.controlHasError("email","email")?21:-1),s(5),d("disabled",i.profileForm.invalid))},dependencies:[Ne,De,W,Q,H,q,Pe,Ue,Be,G,Oe,$,V,ke,Ee,we,Se],styles:[".update-profile-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:40px 20px;background-color:#f9f9f9}.update-profile-card[_ngcontent-%COMP%]{width:100%;max-width:600px;background-color:#fff;border-radius:12px;box-shadow:0 4px 8px #0000001a;padding:30px}.update-profile-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#333;font-size:24px;font-weight:700;margin-bottom:20px;border-bottom:2px solid #6cbf84;padding-bottom:10px}.form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#2c3e50}.mat-input-element[_ngcontent-%COMP%]{color:#333}.mat-hint[_ngcontent-%COMP%], .mat-error[_ngcontent-%COMP%]{font-size:13px;color:#d9534f}.submit-button[_ngcontent-%COMP%]{display:inline-block;width:100%;padding:10px 0;font-size:16px;font-weight:700;background-color:#6cbf84;color:#fff;border:none;border-radius:5px;transition:background-color .3s ease;cursor:pointer}.submit-button[_ngcontent-%COMP%]:hover{background-color:#5ba873}@media (max-width: 600px){.update-profile-card[_ngcontent-%COMP%]{padding:20px}.update-profile-form[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:22px}}"]})};var ee=class o{profile;userProfileService=c(U);authService=c(E);router=c(P);snackBar=c(J);ngOnInit(){this.loadUserProfile()}loadUserProfile(){let e=this.authService.getUser()?.id;e?this.userProfileService.getUserProfile(e).subscribe({next:i=>{this.profile=i,this.showSnackBar("Perfil cargado con \xE9xito")},error:i=>{this.showSnackBar("Error al cargar el perfil")}}):(this.showSnackBar("Usuario no autenticado"),this.router.navigate(["/auth/login"]))}navigateToUpdateProfile(){this.router.navigate(["/customer/profile/update"])}showSnackBar(t){this.snackBar.open(t,"Cerrar",{duration:3e3})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-user-profile"]],standalone:!0,features:[m],decls:17,vars:4,consts:[[1,"container"],[1,"update-button",3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Perfil de Usuario"),n(),r(3,"p")(4,"strong"),a(5,"Nombre:"),n(),a(6),n(),r(7,"p")(8,"strong"),a(9,"Email:"),n(),a(10),n(),r(11,"p")(12,"strong"),a(13,"Direcci\xF3n de Env\xEDo:"),n(),a(14),n(),r(15,"button",1),g("click",function(){return i.navigateToUpdateProfile()}),a(16," Actualizar Perfil "),n()()),e&2&&(s(6),ce(" ",i.profile.firstName," ",i.profile.lastName,""),s(4),u(" ",i.profile.email,""),s(4),u(" ",i.profile.shippingAddress,""))},dependencies:[v],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:40px auto;padding:30px;border:1px solid #e0e0e0;border-radius:10px;background-color:#fff;box-shadow:0 6px 12px #0000001a}h2[_ngcontent-%COMP%]{color:#2c3e50;font-size:28px;font-weight:700;border-bottom:3px solid #3498db;padding-bottom:12px;margin-bottom:25px}p[_ngcontent-%COMP%]{margin:15px 0;font-size:18px;line-height:1.8;color:#4a4a4a}strong[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.update-button[_ngcontent-%COMP%]{display:inline-block;margin-top:20px;padding:10px 20px;background-color:#6cbf84;color:#fff;border:none;border-radius:5px;font-size:16px;cursor:pointer;transition:background-color .3s ease}.update-button[_ngcontent-%COMP%]:hover{background-color:#158467}"]})};var R=class o{baseURL=`${_.apiUrl}/purchases`;http=c(I);getAllPurchases(){return this.http.get(this.baseURL)}createPurchase(t){return this.http.post(this.baseURL,t)}getPurchaseHistory(){return this.http.get(`${this.baseURL}/user`)}getPurchaseReport(){return this.http.get(`${this.baseURL}/report`)}getPurchaseById(t){return this.http.get(`${this.baseURL}/${t}`)}confirmPurchase(t){return this.http.put(`${this.baseURL}/confirm/${t}`,{})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};var Xe=(o,t)=>t.id,Ye=(o,t)=>t.bookId;function Ze(o,t){if(o&1&&(r(0,"div",9)(1,"span"),a(2),n(),r(3,"span"),a(4),n(),r(5,"span"),a(6),y(7,"currency"),n()()),o&2){let e=t.$implicit;s(2),L(e.bookTitle),s(2),u("Cantidad: ",e.quantity,""),s(2),u("Precio: ",O(7,3,e.price),"")}}function et(o,t){if(o&1&&(r(0,"div",3)(1,"div",4)(2,"span",5),a(3),y(4,"date"),n(),r(5,"span",6),a(6),n()(),r(7,"div",7),a(8),y(9,"currency"),n()(),r(10,"div",8)(11,"h3"),a(12,"Libros Comprados:"),n(),M(13,Ze,8,5,"div",9,Ye),n()),o&2){let e=t.$implicit,i=x(2);s(3),u("Fecha: ",O(4,4,e.createdAt),""),s(2),d("ngClass",i.getPaymentStatusClass(e.paymentStatus)),s(),u(" Estado: ",e.paymentStatus," "),s(2),u(" Total: ",O(9,6,e.total)," "),s(5),k(e.items)}}function tt(o,t){if(o&1&&(r(0,"div")(1,"div",1)(2,"div",2),M(3,et,15,8,null,null,Xe),n()()()),o&2){let e=x();s(3),k(e.purchases)}}function ot(o,t){o&1&&(r(0,"p"),a(1,"No se encontraron compras en el historial."),n())}var te=class o{purchases=[];purchaseService=c(R);ngOnInit(){this.loadPurchaseHistory()}loadPurchaseHistory(){this.purchaseService.getPurchaseHistory().subscribe({next:t=>this.purchases=t,error:()=>console.error("Error al cargar el historial de compras")})}getPaymentStatusClass(t){switch(t){case"PAID":return"status-paid";case"PENDING":return"status-pending";case"FAILED":return"status-failed";default:return""}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-history"]],standalone:!0,features:[m],decls:5,vars:1,consts:[[1,"history-container"],[1,"purchase-grid"],[1,"purchase-card"],[1,"purchase-info"],[1,"purchase-header"],[1,"purchase-date"],[1,"payment-status",3,"ngClass"],[1,"purchase-total"],[1,"purchase-items"],[1,"purchase-item"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Historial de Compras"),n(),C(3,tt,5,0,"div")(4,ot,2,0,"p"),n()),e&2&&(s(3),b(i.purchases.length>0?3:4))},dependencies:[v,z,A,ue],styles:[".history-container[_ngcontent-%COMP%]{max-width:900px;margin:auto;padding:20px;background-color:#f9f9f9;border-radius:8px}h2[_ngcontent-%COMP%]{text-align:center;color:#333;font-size:1.8rem;margin-bottom:20px}.purchase-card[_ngcontent-%COMP%]{background-color:#fff;padding:25px;border-radius:8px;box-shadow:0 4px 8px #0000001a;margin-bottom:20px;border:1px solid #e0e0e0}.purchase-card[_ngcontent-%COMP%]:not(:last-child){margin-bottom:30px}.purchase-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:1rem;margin-bottom:10px}.purchase-id[_ngcontent-%COMP%], .purchase-date[_ngcontent-%COMP%]{font-weight:700;color:#555}.payment-status[_ngcontent-%COMP%]{padding:6px 10px;border-radius:5px;font-size:.9rem}.status-paid[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.status-pending[_ngcontent-%COMP%]{background-color:#ffc107;color:#333}.status-failed[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff}.purchase-total[_ngcontent-%COMP%]{font-weight:700;color:#333;font-size:1.1rem;margin-top:10px}.purchase-items[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;color:#333;margin-top:15px}.purchase-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:1rem;color:#666;padding:8px 0;border-bottom:1px solid #ddd}.purchase-item[_ngcontent-%COMP%]:last-child{border-bottom:none}"]})};var oe=class o{bookId;route=c(j);constructor(){this.bookId=+this.route.snapshot.paramMap.get("id"),console.log(this.bookId)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-book-info-page"]],standalone:!0,features:[m],decls:6,vars:2,consts:[[1,"book-info-page-container"],[1,"book-content"],[3,"bookId"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Detalles del Libro"),n(),r(3,"div",1),p(4,"app-book-details",2)(5,"app-book-reviews",2),n()()),e&2&&(s(4),d("bookId",i.bookId),s(),d("bookId",i.bookId))},dependencies:[Le,ze],styles:[".book-info-page-container[_ngcontent-%COMP%]{max-width:1200px;margin:auto;padding:20px}h2[_ngcontent-%COMP%]{text-align:center;color:#333;font-size:2rem;margin-bottom:20px}.book-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;padding:0 10px}app-book-details[_ngcontent-%COMP%], app-book-reviews[_ngcontent-%COMP%]{flex:1;border-radius:8px;overflow:hidden;padding:20px;background-color:#fff}app-book-details[_ngcontent-%COMP%]{max-width:100%}app-book-reviews[_ngcontent-%COMP%]{max-width:100%}@media (min-width: 768px){.book-content[_ngcontent-%COMP%]{flex-direction:row;gap:40px;align-items:flex-start}app-book-details[_ngcontent-%COMP%]{max-width:65%}app-book-reviews[_ngcontent-%COMP%]{max-width:35%}}@media (max-width: 767px){h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:15px}.book-content[_ngcontent-%COMP%]{padding:0}app-book-details[_ngcontent-%COMP%], app-book-reviews[_ngcontent-%COMP%]{padding:15px}.book-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{box-shadow:0 2px 5px #0000001a}}"]})};var ne=class o{baseURL=`${_.apiUrl}/checkout`;http=c(I);createPaypalOrder(t){let e=new fe;return e=e.append("purchaseId",t),e=e.append("returnUrl",_.paypalReturnUrl),e=e.append("cancelUrl",_.paypalReturnUrl),this.http.post(`${this.baseURL}/create`,null,{params:e})}capturePaypalOrder(t){return this.http.post(`${this.baseURL}/capture?orderId=${t}`,null)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};var nt=(o,t)=>t.bookId;function rt(o,t){if(o&1){let e=ae();r(0,"div",1)(1,"div",7)(2,"span",8),a(3),n(),r(4,"span",9),a(5),n(),r(6,"span",10),a(7),y(8,"currency"),n()(),r(9,"button",11),g("click",function(){let f=B(e).$implicit,F=x(2);return T(F.removeItem(f.bookId))}),a(10,"Eliminar"),n()()}if(o&2){let e=t.$implicit;s(3),L(e.bookName),s(2),u("Cantidad: ",e.quantity,""),s(2),u("Precio: ",O(8,3,e.price),"")}}function it(o,t){if(o&1){let e=ae();r(0,"div"),M(1,rt,11,5,"div",1,nt),r(3,"div",2)(4,"strong"),a(5),y(6,"currency"),n()(),r(7,"div",3)(8,"button",4),g("click",function(){B(e);let f=x();return T(f.clearCart())}),a(9,"Vaciar Carrito"),n(),r(10,"button",5),g("click",function(){B(e);let f=x();return T(f.proceedToCheckout())}),p(11,"img",6),n()()()}if(o&2){let e=x();s(),k(e.cartItems),s(4),u("Total: ",O(6,4,e.total),""),s(5),D("spinner",e.loading),d("disabled",e.loading)}}function at(o,t){o&1&&(r(0,"p"),a(1,"Tu carrito est\xE1 vac\xEDo."),n())}var re=class o{cartItems=[];total=0;loading=!1;customerId;purchaseService=c(R);checkoutService=c(ne);cartService=c(Te);router=c(P);route=c(j);authService=c(E);ngOnInit(){this.loadCart(),this.customerId=this.authService.getUser()?.customerId||0;let t=this.route.snapshot.queryParamMap.get("token"),e=this.route.snapshot.queryParamMap.get("PayerID");t&&e&&(this.loading=!0,this.checkoutService.capturePaypalOrder(t).subscribe(i=>{i.completed&&(this.clearCart(),this.router.navigate(["/customer/cart",i.purchaseId]))}))}loadCart(){this.cartItems=this.cartService.getCartItems(),this.total=this.cartService.getCartTotal()}removeItem(t){this.cartService.removeFromCart(t),this.loadCart()}clearCart(){this.cartService.clearCart(),this.loadCart()}proceedToCheckout(){let t=this.cartService.getCartItems(),e={total:this.total,customerId:this.customerId,items:t.map(i=>({bookId:i.bookId,bookName:i.bookName,quantity:i.quantity,price:i.price}))};this.loading=!0,this.purchaseService.createPurchase(e).subscribe(i=>{this.checkoutService.createPaypalOrder(i.id).subscribe(f=>{window.location.href=f.paypalUrl})})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=l({type:o,selectors:[["app-cart"]],standalone:!0,features:[m],decls:5,vars:1,consts:[[1,"cart-container"],[1,"cart-item"],[1,"cart-total"],[1,"cart-actions"],[1,"clear-cart-button",3,"click"],[1,"paypal-button",3,"click","disabled"],["src","https://www.paypalobjects.com/webstatic/en_US/i/buttons/checkout-logo-large.png","alt","PayPal Checkout"],[1,"item-info"],[1,"item-title"],[1,"item-quantity"],[1,"item-price"],[1,"remove-button",3,"click"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"h2"),a(2,"Carrito de Compras"),n(),C(3,it,12,6,"div")(4,at,2,0,"p"),n()),e&2&&(s(3),b(i.cartItems.length>0?3:4))},dependencies:[v,A],styles:[".cart-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px;border-radius:8px}h2[_ngcontent-%COMP%]{text-align:center;color:#333;font-size:1.8rem}.cart-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px;margin-bottom:10px;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.item-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.item-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#333}.item-quantity[_ngcontent-%COMP%], .item-price[_ngcontent-%COMP%]{color:#555;font-size:.9rem}.remove-button[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;border:none;padding:8px 12px;border-radius:5px;cursor:pointer;transition:background-color .3s}.remove-button[_ngcontent-%COMP%]:hover{background-color:#c0392b}.cart-total[_ngcontent-%COMP%]{margin-top:20px;text-align:right;font-size:1.2rem;font-weight:700;color:#333}.cart-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}.clear-cart-button[_ngcontent-%COMP%], .paypal-button[_ngcontent-%COMP%]{padding:10px 20px;border-radius:5px;cursor:pointer;transition:background-color .3s}.clear-cart-button[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;border:none}.clear-cart-button[_ngcontent-%COMP%]:hover{background-color:#c0392b}.paypal-button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;display:flex;align-items:center;justify-content:center}.paypal-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:24px}.paypal-button.spinner[_ngcontent-%COMP%]{cursor:not-allowed;opacity:.6}"]})};var Go=[{path:"",component:Y,children:[{path:"catalog",component:K},{path:"catalog/details/:id",component:oe},{path:"cart",component:re},{path:"collection",component:X},{path:"profile",component:ee},{path:"profile/update",component:Z},{path:"purchases/history",component:te}]}];export{Go as customerRoutes};
