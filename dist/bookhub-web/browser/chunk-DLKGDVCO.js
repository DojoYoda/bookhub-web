import{a as k,b as v,c as x,d as h,e as te,f as E,g as T,h as oe,i as _}from"./chunk-DXC545UM.js";import{a as z,b as ae}from"./chunk-ZFCHSQAQ.js";import{ma as ie,na as ne,w as Z,x as ee}from"./chunk-MZVIVPNZ.js";import{b as Q,h as W,j as D,n as X,p as R}from"./chunk-DB5X7ORZ.js";import{$b as J,Db as V,Gb as f,Hc as B,Ib as p,Ic as Y,Jc as y,Sb as a,Ta as P,Tb as s,Ub as u,Vb as K,Wa as c,Z as M,_b as C,bc as m,ca as $,cc as b,da as d,dc as G,ha as g,lb as N,pb as O,qa as I,ra as w,tb as j,ub as q,vb as H,wb as L,xb as n,yb as i,zb as S}from"./chunk-2LSH2JKS.js";var re=class o{book;isCustomer=!1;authService=d(R);router=d(D);constructor(){}ngOnInit(){this.isCustomer=this.authService.getUserRole()==="CUSTOMER"}viewDetails(){let t=this.isCustomer?"/customer/catalog/details":"/home/book-details";this.router.navigate([t,this.book.id])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-book-card"]],inputs:{book:"book"},standalone:!0,features:[C],decls:16,vars:8,consts:[[1,"book-card"],["mat-card-image","",3,"src","alt"],["mat-button","",3,"click"]],template:function(e,r){e&1&&(n(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title"),a(3),i(),n(4,"mat-card-subtitle"),a(5),i()(),S(6,"img",1),m(7,"apiImg"),n(8,"mat-card-content")(9,"p"),a(10),i(),n(11,"p"),a(12),i()(),n(13,"mat-card-actions")(14,"button",2),f("click",function(){return r.viewDetails()}),a(15,"Ver detalles"),i()()()),e&2&&(c(3),s(r.book.title),c(2),u("Autor: ",r.book.authorName,""),c(),O("src",b(7,6,r.book.coverPath),P)("alt",r.book.title),c(4),s(r.book.description),c(2),u("Precio: ",r.book.price,""))},dependencies:[_,k,te,x,E,T,h,v,z],styles:[".book-card[_ngcontent-%COMP%]{width:300px;transition:transform .3s ease,box-shadow .3s ease}.book-card[_ngcontent-%COMP%]:hover{transform:translateY(-10px);box-shadow:0 8px 16px #0003}mat-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;overflow:hidden}mat-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:4px}mat-card-title[_ngcontent-%COMP%], mat-card-subtitle[_ngcontent-%COMP%]{color:#333}mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;font-size:14px;line-height:1.6}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#1abc9c;color:#fff;border:none;border-radius:5px;padding:8px 16px;font-weight:700;transition:background-color .3s ease,box-shadow .3s ease;cursor:pointer}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#158467}"]})};var F=class o{constructor(t){this.http=t}baseURL=`${X.apiUrl}/books`;getRecentBooks(){return this.http.get(`${this.baseURL}/recent`)}getBookDetailsById(t){return this.http.get(`${this.baseURL}/${t}`)}static \u0275fac=function(e){return new(e||o)($(Q))};static \u0275prov=M({token:o,factory:o.\u0275fac,providedIn:"root"})};var U=class o{cartKey="cartItems";constructor(){}getCartItems(){let t=localStorage.getItem(this.cartKey);return t?JSON.parse(t):[]}addToCart(t){let e=this.getCartItems(),r=e.findIndex(l=>l.bookId===t.bookId);r!==-1?(e[r].quantity+=t.quantity,e[r].price=t.price):e.push(t),this.saveCartItems(e)}removeFromCart(t){let e=this.getCartItems().filter(r=>r.bookId!==t);this.saveCartItems(e)}clearCart(){localStorage.removeItem(this.cartKey)}saveCartItems(t){localStorage.setItem(this.cartKey,JSON.stringify(t))}getCartTotal(){return this.getCartItems().reduce((e,r)=>e+r.price*r.quantity,0)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=M({token:o,factory:o.\u0275fac,providedIn:"root"})};function pe(o,t){if(o&1){let e=V();n(0,"button",11),f("click",function(){I(e);let l=p(2);return w(l.addToCart())}),a(1,"Agregar al carrito"),i(),n(2,"button",12),f("click",function(){I(e);let l=p(2);return w(l.goBackToHome())}),a(3,"Regresar a Home"),i()}}function ue(o,t){if(o&1){let e=V();n(0,"button",12),f("click",function(){I(e);let l=p(2);return w(l.goBackToHome())}),a(1,"Regresar a Home"),i()}}function be(o,t){if(o&1&&(n(0,"mat-card",0),S(1,"img",2),m(2,"apiImg"),n(3,"div",3)(4,"mat-card-title",4),a(5),i(),n(6,"mat-card-subtitle",5),a(7),i(),n(8,"mat-card-content")(9,"p",6),a(10),i(),n(11,"p",7)(12,"strong"),a(13,"Precio:"),i(),a(14),m(15,"currency"),i(),n(16,"p",8)(17,"strong"),a(18,"Publicado el:"),i(),a(19),m(20,"date"),i(),n(21,"p",8)(22,"strong"),a(23,"\xDAltima actualizaci\xF3n:"),i(),a(24),m(25,"date"),i()(),n(26,"div",9),N(27,pe,4,0)(28,ue,2,0,"button",10),i()()()),o&2){let e=p();c(),O("src",b(2,10,e.book.coverPath),P)("alt",e.book.title),c(4),s(e.book.title),c(2),K("Autor: ",e.book.authorName," - Categor\xEDa: ",e.book.categoryName,""),c(3),s(e.book.description),c(4),u(" ",b(15,12,e.book.price),""),c(5),u(" ",b(20,14,e.book.createdAt),""),c(5),u(" ",b(25,16,e.book.updatedAt),""),c(3),j(e.isAuthenticated&&e.isCustomer?27:28)}}function ge(o,t){o&1&&(n(0,"p",1),a(1,"No se encontr\xF3 el libro"),i())}var de=class o{book;bookId;route=d(W);bookService=d(ae);homeService=d(F);router=d(D);authService=d(R);snackBar=d(ie);cartService=d(U);isAuthenticated=!1;isCustomer=!1;constructor(){}ngOnInit(){this.isAuthenticated=this.authService.isAuthenticated(),this.isCustomer=this.authService.getUserRole()==="CUSTOMER",this.bookId&&this.loadBookDetails(this.bookId)}loadBookDetails(t){this.homeService.getBookDetailsById(t).subscribe({next:e=>this.book=e,error:()=>this.showSnackBar("Error al cargar detalles del libro")})}goBackToHome(){let t=this.isCustomer?"/customer/catalog":"/home";this.router.navigate([t])}addToCart(){if(!this.isCustomer){this.showSnackBar("Debe iniciar sesi\xF3n como cliente para agregar al carrito");return}let t={bookId:this.book.id,bookName:this.book.title,quantity:1,price:this.book.price};this.cartService.addToCart(t),console.log("Libro agregado al carrito:",t),this.showSnackBar("Libro agregado al carrito")}showSnackBar(t){this.snackBar.open(t,"Cerrar",{duration:3e3})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-book-details"]],inputs:{bookId:"bookId"},standalone:!0,features:[C],decls:2,vars:1,consts:[[1,"book-details-card"],[1,"no-book-message"],["mat-card-image","",1,"book-cover",3,"src","alt"],[1,"book-content"],[1,"book-title"],[1,"book-subtitle"],[1,"book-description"],[1,"book-price"],[1,"book-date"],[1,"button-group"],[1,"back-button"],[1,"add-to-cart-button","auth-required",3,"click"],[1,"back-button",3,"click"]],template:function(e,r){e&1&&N(0,be,29,18,"mat-card",0)(1,ge,2,0,"p",1),e&2&&j(r.book?0:1)},dependencies:[y,Y,B,_,k,x,T,h,v,ne,z],styles:[".book-details-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;max-width:800px;margin:auto;transition:box-shadow .3s ease;border-radius:8px;overflow:hidden;background-color:#fff}.book-cover[_ngcontent-%COMP%]{width:40%;height:auto;object-fit:cover}.book-content[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;justify-content:space-between}.book-title[_ngcontent-%COMP%]{color:#333;font-weight:700;font-size:1.5rem;margin:0}.book-subtitle[_ngcontent-%COMP%]{color:#555;font-size:1rem;margin:5px 0 15px}.book-description[_ngcontent-%COMP%]{color:#666;font-size:1rem;line-height:1.6;margin-bottom:20px}.book-price[_ngcontent-%COMP%], .book-date[_ngcontent-%COMP%]{font-size:1rem;color:#333;margin-bottom:10px}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:15px;flex-wrap:wrap;justify-content:flex-end}.download-link[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%], .add-to-cart-button[_ngcontent-%COMP%]{display:inline-block;text-decoration:none;padding:10px 20px;background-color:#1abc9c;color:#fff;border-radius:5px;font-weight:700;text-align:center;transition:background-color .3s ease,box-shadow .3s ease;cursor:pointer;min-width:120px}.download-link[_ngcontent-%COMP%]:hover, .back-button[_ngcontent-%COMP%]:hover, .add-to-cart-button[_ngcontent-%COMP%]:hover{background-color:#158467;box-shadow:0 4px 8px #0003}.no-book-message[_ngcontent-%COMP%]{text-align:center;font-size:1.2rem;color:#666;background-color:#f8f8f8;padding:20px;max-width:600px;margin:40px auto}@media (max-width: 768px){.book-details-card[_ngcontent-%COMP%]{flex-direction:column;max-width:100%}.book-cover[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:8px 8px 0 0}.book-content[_ngcontent-%COMP%]{padding:15px}.book-title[_ngcontent-%COMP%]{font-size:1.3rem}.book-description[_ngcontent-%COMP%], .book-price[_ngcontent-%COMP%], .book-date[_ngcontent-%COMP%]{font-size:.95rem}.download-link[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%], .add-to-cart-button[_ngcontent-%COMP%]{padding:8px 15px;font-size:.9rem}}"]})};var fe=()=>[1,2,3,4,5];function Ce(o,t){if(o&1&&(n(0,"mat-icon"),a(1),i()),o&2){let e=t.$implicit,r=p().$implicit;c(),s(e<=r.rating?"star":"star_border")}}function ke(o,t){if(o&1&&(n(0,"mat-card",1)(1,"mat-card-header")(2,"div",2),a(3),i(),n(4,"mat-card-title"),a(5),i(),n(6,"mat-card-subtitle"),a(7),m(8,"date"),i()(),n(9,"mat-card-content")(10,"div",3),H(11,Ce,2,1,"mat-icon",null,q),i(),n(13,"p",4),a(14),i()()()),o&2){let e=t.$implicit;c(3),s(e.reviewer[0]),c(2),s(e.reviewer),c(2),s(G(8,4,e.date,"longDate")),c(4),L(J(7,fe)),c(3),s(e.comment)}}function ve(o,t){o&1&&(n(0,"p"),a(1,"No hay rese\xF1as disponibles"),i())}var me=class o{bookId;reviews=[{reviewer:"Juan P\xE9rez",date:"2024-10-01",rating:4,comment:"Excelente libro, muy bien explicado y f\xE1cil de entender."},{reviewer:"Ana Gonz\xE1lez",date:"2024-09-28",rating:5,comment:"Una gu\xEDa completa y detallada. Me ayud\xF3 mucho en mi proyecto."},{reviewer:"Luis Mendoza",date:"2024-09-15",rating:3,comment:"Buen libro, aunque algunos temas podr\xEDan tener m\xE1s profundidad."},{reviewer:"Mar\xEDa Lopez",date:"2024-09-05",rating:4,comment:"Lo recomendar\xEDa a cualquier estudiante de programaci\xF3n."}];ngOnInit(){console.log("Rese\xF1as del libro ID:",this.bookId)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=g({type:o,selectors:[["app-book-reviews"]],inputs:{bookId:"bookId"},standalone:!0,features:[C],decls:6,vars:1,consts:[[1,"reviews-container"],[1,"review-card"],["mat-card-avatar","",1,"review-avatar"],[1,"rating"],[1,"comment"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"h2"),a(2,"Rese\xF1as de Libros"),i(),H(3,ke,15,8,"mat-card",1,q,!1,ve,2,0,"p"),i()),e&2&&(c(3),L(r.reviews))},dependencies:[_,k,oe,x,E,h,v,ee,Z,y,B],styles:[".reviews-container[_ngcontent-%COMP%]{max-width:800px;margin:auto;padding:20px}h2[_ngcontent-%COMP%]{text-align:center;color:#333;margin-bottom:20px}.review-card[_ngcontent-%COMP%]{margin-bottom:20px;border-radius:8px}.mat-card-header[_ngcontent-%COMP%]{display:flex;align-items:center}.review-avatar[_ngcontent-%COMP%]{background-color:#1abc9c;color:#fff;font-weight:700;display:flex;align-items:center;justify-content:center;border-radius:50%}.rating[_ngcontent-%COMP%]{color:gold;margin:5px 0}.comment[_ngcontent-%COMP%]{color:#555;font-size:1rem;line-height:1.4;margin-top:10px}.review-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 10px #00000026;transition:box-shadow .3s ease}"]})};export{re as a,F as b,U as c,de as d,me as e};
